# ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Event Booking API

## ğŸ“‹ Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ
1. [ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°](#Ğ¾Ğ±Ñ‰Ğ°Ñ-Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°)
2. [Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°](#Ğ¶Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹-Ñ†Ğ¸ĞºĞ»-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°)
3. [Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ](#Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ)
4. [Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²](#ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°-Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²)
5. [ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ‘Ğ”](#Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ-Ğº-Ğ±Ğ´)
6. [ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸](#Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸)
7. [ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ](#Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸-Ğ¸-ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ)
8. [Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹](#Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ-ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹)

---

## 1. ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ĞšĞ›Ğ˜Ğ•ĞĞ¢                              â”‚
â”‚              (Browser, Postman, curl)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP Request
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DOCKER COMPOSE                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              EVENT-BOOKING-API                       â”‚   â”‚
â”‚  â”‚              (Node.js Container)                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚            EXPRESS.JS APP                      â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         MIDDLEWARE                       â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Helmet (Security)                     â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ CORS                                  â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Body Parser                           â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Logger                                â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                     â–¼                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         ROUTES / CONTROLLERS             â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ /api/events                           â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ /api/bookings                         â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ /health                               â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                     â–¼                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚            SERVICES                      â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ bookingService                        â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ eventService                          â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°)                         â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                     â–¼                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚         REPOSITORIES                     â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ bookingRepository                     â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ eventRepository                       â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  (SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ + Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸)              â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                     â–¼                          â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚        CONNECTION POOL                   â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚        (pg pool)                         â”‚ â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚ PostgreSQL Protocol               â”‚
â”‚                         â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           EVENT-BOOKING-DB                           â”‚   â”‚
â”‚  â”‚           (PostgreSQL Container)                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚            DATABASE: event_booking             â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ TABLE: eventsâ”‚    â”‚TABLE:bookingsâ”‚         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚â€¢ id          â”‚    â”‚â€¢ id          â”‚         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚â€¢ name        â”‚â—„â”€â”€â”€â”¤â€¢ event_id    â”‚         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚â€¢ total_seats â”‚    â”‚â€¢ user_id     â”‚         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â”‚â€¢ created_at  â”‚    â”‚â€¢ created_at  â”‚         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚   â”‚
â”‚  â”‚  â”‚                                                â”‚ â”‚   â”‚
â”‚  â”‚  â”‚  UNIQUE INDEX: (event_id, user_id)            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: POST /api/bookings/reserve

```
ĞšĞ›Ğ˜Ğ•ĞĞ¢
  â”‚
  â”‚ 1. HTTP POST /api/bookings/reserve
  â”‚    Body: {"event_id": 1, "user_id": "user123"}
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/index.ts                                        â”‚
â”‚ â€¢ Ğ—Ğ°Ğ¿ÑƒÑĞº HTTP ÑĞµÑ€Ğ²ĞµÑ€Ğ° (Express)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/app.ts                                          â”‚
â”‚ â€¢ app.use(helmet())        â† Security headers       â”‚
â”‚ â€¢ app.use(cors())          â† CORS Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸        â”‚
â”‚ â€¢ app.use(express.json())  â† ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ JSON          â”‚
â”‚ â€¢ app.use(logger)          â† Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/routes/index.ts                                 â”‚
â”‚ â€¢ ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ /api                      â”‚
â”‚ â€¢ ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ´Ğ¾Ñ‡ĞµÑ€Ğ½Ğ¸Ğµ Ñ€Ğ¾ÑƒÑ‚Ñ‹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/routes/bookingRoutes.ts                         â”‚
â”‚ â€¢ POST /reserve â†’ middleware â†’ controller           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/middleware/validate.ts                          â”‚
â”‚ 2. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ‡ĞµÑ€ĞµĞ· Zod               â”‚
â”‚    â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ğ¸Ğ¿Ğ¾Ğ²                                 â”‚
â”‚    â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğ¹ (event_id > 0)            â”‚
â”‚    â€¢ Ğ•ÑĞ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° â†’ next(error) â†’ errorHandler       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/controllers/bookingController.ts                â”‚
â”‚ 3. BookingController.createBooking()                â”‚
â”‚    â€¢ Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ event_id Ğ¸ user_id Ğ¸Ğ· req.body       â”‚
â”‚    â€¢ Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ bookingService.createBooking()        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/services/bookingService.ts                      â”‚
â”‚ 4. BookingService.createBooking()                   â”‚
â”‚    â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ·          â”‚
â”‚      eventRepository.getEventById()                 â”‚
â”‚    â€¢ Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ bookingRepository.createBooking()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/repositories/bookingRepository.ts               â”‚
â”‚ 5. BookingRepository.createBooking()                â”‚
â”‚    â€¢ const client = await pool.connect()            â”‚
â”‚    â€¢ BEGIN TRANSACTION                              â”‚
â”‚    â€¢ SELECT * FROM events WHERE id=$1 FOR UPDATE    â”‚
â”‚    â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚                        â”‚
â”‚    â€¢ INSERT INTO bookings (event_id, user_id)       â”‚
â”‚    â€¢ COMMIT                                         â”‚
â”‚    â€¢ client.release()                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/config/database.ts                              â”‚
â”‚ 6. Connection Pool                                  â”‚
â”‚    â€¢ Ğ‘ĞµÑ€Ñ‘Ñ‚ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ğ¿ÑƒĞ»Ğ°                       â”‚
â”‚    â€¢ Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ                           â”‚
â”‚    â€¢ Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL Database                                 â”‚
â”‚ 7. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ SQL Ğ½Ğ° ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ Ğ‘Ğ”                      â”‚
â”‚    â€¢ Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ (FOR UPDATE)                 â”‚
â”‚    â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° UNIQUE constraint                     â”‚
â”‚    â€¢ Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…                                 â”‚
â”‚    â€¢ Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ 8. Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾
                      â”‚    Repository â†’ Service â†’ Controller
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Controller Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚                         â”‚
â”‚ res.status(201).json({                              â”‚
â”‚   id, event_id, user_id, created_at,                â”‚
â”‚   message: "Booking created successfully"           â”‚
â”‚ })                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
                   ĞšĞ›Ğ˜Ğ•ĞĞ¢
            ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ JSON Ğ¾Ñ‚Ğ²ĞµÑ‚
```

### ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

```
ĞÑˆĞ¸Ğ±ĞºĞ° Ğ½Ğ° Ğ»ÑĞ±Ğ¾Ğ¼ ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ
        â”‚
        â–¼
   next(error)
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/middleware/errorHandler.ts  â”‚
â”‚ â€¢ Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ               â”‚
â”‚ â€¢ ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ñ‚Ğ¸Ğ¿ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸:        â”‚
â”‚   - ZodError â†’ 400              â”‚
â”‚   - NotFoundError â†’ 404         â”‚
â”‚   - ConflictError â†’ 409         â”‚
â”‚   - AppError â†’ statusCode       â”‚
â”‚   - Unknown â†’ 500               â”‚
â”‚ â€¢ Ğ¤Ğ¾Ñ€Ğ¼Ğ¸Ñ€ÑƒĞµÑ‚ JSON Ğ¾Ñ‚Ğ²ĞµÑ‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
           ĞšĞ»Ğ¸ĞµĞ½Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚
           { error, message }
```

---

## 3. Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

### ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

```
1. DOCKER-COMPOSE UP
   â”‚
   â”œâ”€â–º Ğ—Ğ°Ğ¿ÑƒÑĞº PostgreSQL ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
   â”‚   â””â”€â–º Healthcheck: pg_isready
   â”‚       â””â”€â–º Ğ–Ğ´Ñ‘Ñ‚ Ğ¿Ğ¾ĞºĞ° Ğ‘Ğ” Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ°
   â”‚
   â””â”€â–º Ğ—Ğ°Ğ¿ÑƒÑĞº API ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° (depends_on postgres)
       â”‚
       â””â”€â–º Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Dockerfile
           â”‚
           â”œâ”€â–º npm ci (ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹)
           â”œâ”€â–º npm run build (ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ TypeScript)
           â””â”€â–º npm start (Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ)
               â”‚
               â””â”€â–º node dist/index.js
                   â”‚
                   â–¼

2. src/index.ts - ENTRY POINT
   â”‚
   â”œâ”€â–º import app from './app'
   â”œâ”€â–º import env from './config/env'
   â”œâ”€â–º import pool from './config/database'
   â”‚
   â”œâ”€â–º app.listen(PORT)
   â”‚   â””â”€â–º HTTP ÑĞµÑ€Ğ²ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 3000
   â”‚
   â”œâ”€â–º Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ² ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ²:
   â”‚   â”œâ”€â–º process.on('SIGTERM', gracefulShutdown)
   â”‚   â”œâ”€â–º process.on('SIGINT', gracefulShutdown)
   â”‚   â”œâ”€â–º process.on('unhandledRejection')
   â”‚   â””â”€â–º process.on('uncaughtException')
   â”‚
   â””â”€â–º Logger: "Server is running on port 3000"

3. src/app.ts - EXPRESS APP SETUP
   â”‚
   â”œâ”€â–º const app = express()
   â”‚
   â”œâ”€â–º ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ middleware (Ğ¿Ğ¾ Ğ¿Ğ¾Ñ€ÑĞ´ĞºÑƒ):
   â”‚   â”œâ”€â–º helmet() - Security headers
   â”‚   â”œâ”€â–º cors() - CORS Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
   â”‚   â”œâ”€â–º express.json() - ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ JSON
   â”‚   â”œâ”€â–º express.urlencoded() - ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ form data
   â”‚   â””â”€â–º Custom logger middleware
   â”‚
   â”œâ”€â–º Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ routes:
   â”‚   â”œâ”€â–º GET /health
   â”‚   â””â”€â–º app.use('/api', routes)
   â”‚       â”œâ”€â–º /api/events
   â”‚       â””â”€â–º /api/bookings
   â”‚
   â””â”€â–º ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:
       â”œâ”€â–º notFoundHandler (404)
       â””â”€â–º errorHandler (Ğ²ÑĞµ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ)

4. src/config/env.ts - Ğ’ĞĞ›Ğ˜Ğ”ĞĞ¦Ğ˜Ğ¯ ĞĞšĞ Ğ£Ğ–Ğ•ĞĞ˜Ğ¯
   â”‚
   â”œâ”€â–º dotenv.config() - Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° .env Ñ„Ğ°Ğ¹Ğ»Ğ°
   â”‚
   â”œâ”€â–º envSchema.parse(process.env)
   â”‚   â””â”€â–º Zod Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚:
   â”‚       â”œâ”€â–º NODE_ENV (development/production)
   â”‚       â”œâ”€â–º PORT (Ñ‡Ğ¸ÑĞ»Ğ¾ > 0)
   â”‚       â”œâ”€â–º DATABASE_URL (Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ URL)
   â”‚       â””â”€â–º LOG_LEVEL (error/warn/info/debug)
   â”‚
   â””â”€â–º Ğ•ÑĞ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° â†’ process.exit(1)

5. src/config/database.ts - CONNECTION POOL
   â”‚
   â”œâ”€â–º new Pool({
   â”‚     connectionString: env.DATABASE_URL,
   â”‚     max: 20,  â† ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹
   â”‚     idleTimeoutMillis: 30000,
   â”‚     connectionTimeoutMillis: 2000
   â”‚   })
   â”‚
   â”œâ”€â–º pool.on('error') - ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
   â”‚
   â””â”€â–º Pool Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

6. ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ• Ğ“ĞĞ¢ĞĞ’Ğ
   â””â”€â–º ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
```

---

## 4. Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

```
event-booking-api/
â”‚
â”œâ”€â”€ ğŸ“ src/                          # Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ index.ts                  # ENTRY POINT
â”‚   â”‚   â””â”€â–º Ğ—Ğ°Ğ¿ÑƒÑĞº HTTP ÑĞµÑ€Ğ²ĞµÑ€Ğ°
â”‚   â”‚   â””â”€â–º Graceful shutdown
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ app.ts                    # EXPRESS APP
â”‚   â”‚   â””â”€â–º ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° middleware
â”‚   â”‚   â””â”€â–º Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ routes
â”‚   â”‚   â””â”€â–º Error handlers
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ config/                   # ĞšĞĞĞ¤Ğ˜Ğ“Ğ£Ğ ĞĞ¦Ğ˜Ğ¯
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ env.ts               # ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â”‚   â”‚   â”‚   â””â”€â–º Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Zod
â”‚   â”‚   â”‚   â””â”€â–º PORT, DATABASE_URL, NODE_ENV
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ database.ts          # ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ‘Ğ”
â”‚   â”‚       â””â”€â–º Connection Pool (pg)
â”‚   â”‚       â””â”€â–º Error handling
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ routes/                   # ĞœĞĞ Ğ¨Ğ Ğ£Ğ¢Ğ«
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ index.ts             # Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€
â”‚   â”‚   â”‚   â””â”€â–º /api â†’ Ğ¿Ğ¾Ğ´Ñ€Ğ¾ÑƒÑ‚Ñ‹
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bookingRoutes.ts     # /api/bookings/*
â”‚   â”‚   â”‚   â”œâ”€â–º POST /reserve
â”‚   â”‚   â”‚   â”œâ”€â–º GET /event/:eventId
â”‚   â”‚   â”‚   â””â”€â–º GET /user/:userId
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ eventRoutes.ts       # /api/events/*
â”‚   â”‚       â”œâ”€â–º GET /
â”‚   â”‚       â””â”€â–º GET /:id
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ controllers/              # HTTP HANDLERS
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bookingController.ts
â”‚   â”‚   â”‚   â””â”€â–º ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ req/res
â”‚   â”‚   â”‚   â””â”€â–º Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ services
â”‚   â”‚   â”‚   â””â”€â–º Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ JSON
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ eventController.ts
â”‚   â”‚       â””â”€â–º ĞĞ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ‡Ğ½Ğ¾
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ services/                 # Ğ‘Ğ˜Ğ—ĞĞ•Ğ¡-Ğ›ĞĞ“Ğ˜ĞšĞ
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bookingService.ts
â”‚   â”‚   â”‚   â””â”€â–º ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ repositories
â”‚   â”‚   â”‚   â””â”€â–º ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ´ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸ĞµĞ¼
â”‚   â”‚   â”‚   â””â”€â–º ĞĞµ Ğ·Ğ½Ğ°ĞµÑ‚ Ğ¾Ğ± HTTP
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ eventService.ts
â”‚   â”‚       â””â”€â–º ĞĞ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ‡Ğ½Ğ¾
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ repositories/             # DATA ACCESS LAYER
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ bookingRepository.ts
â”‚   â”‚   â”‚   â””â”€â–º SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
â”‚   â”‚   â”‚   â””â”€â–º Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
â”‚   â”‚   â”‚   â””â”€â–º CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ eventRepository.ts
â”‚   â”‚       â””â”€â–º SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
â”‚   â”‚       â””â”€â–º Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ middleware/               # EXPRESS MIDDLEWARE
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ validate.ts          # Zod Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
â”‚   â”‚   â”‚   â””â”€â–º validateBody(schema)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ errorHandler.ts      # ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
â”‚   â”‚       â”œâ”€â–º errorHandler()
â”‚   â”‚       â””â”€â–º notFoundHandler()
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ validators/               # ZOD Ğ¡Ğ¥Ğ•ĞœĞ«
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.ts
â”‚   â”‚       â”œâ”€â–º createBookingSchema
â”‚   â”‚       â””â”€â–º envSchema
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ types/                    # TYPESCRIPT Ğ¢Ğ˜ĞŸĞ«
â”‚   â”‚   â””â”€â”€ ğŸ“„ index.ts
â”‚   â”‚       â”œâ”€â–º Event
â”‚   â”‚       â”œâ”€â–º Booking
â”‚   â”‚       â”œâ”€â–º BookingResponse
â”‚   â”‚       â””â”€â–º ErrorResponse
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ utils/                    # Ğ£Ğ¢Ğ˜Ğ›Ğ˜Ğ¢Ğ«
â”‚       â”œâ”€â”€ ğŸ“„ logger.ts             # Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
â”‚       â”‚   â””â”€â–º JSON structured logs
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“„ errors.ts             # Custom Error ĞºĞ»Ğ°ÑÑÑ‹
â”‚           â”œâ”€â–º AppError
â”‚           â”œâ”€â–º NotFoundError
â”‚           â”œâ”€â–º ConflictError
â”‚           â””â”€â–º BadRequestError
â”‚
â”œâ”€â”€ ğŸ“ migrations/                   # SQL ĞœĞ˜Ğ“Ğ ĞĞ¦Ğ˜Ğ˜
â”‚   â””â”€â”€ ğŸ“„ 1700000000000_create-tables.sql
â”‚       â”œâ”€â–º CREATE TABLE events
â”‚       â”œâ”€â–º CREATE TABLE bookings
â”‚       â”œâ”€â–º CREATE UNIQUE INDEX
â”‚       â””â”€â–º INSERT test data
â”‚
â”œâ”€â”€ ğŸ“ scripts/                      # BASH Ğ¡ĞšĞ Ğ˜ĞŸĞ¢Ğ«
â”‚   â”œâ”€â”€ ğŸ“„ check-env.sh             # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
â”‚   â””â”€â”€ ğŸ“„ seed.sh                  # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
â”‚
â”œâ”€â”€ ğŸ“„ .env                          # ĞŸĞ•Ğ Ğ•ĞœĞ•ĞĞĞ«Ğ• ĞĞšĞ Ğ£Ğ–Ğ•ĞĞ˜Ğ¯
â”‚   â”œâ”€â–º NODE_ENV=development
â”‚   â”œâ”€â–º PORT=3000
â”‚   â”œâ”€â–º DATABASE_URL=postgresql://...
â”‚   â””â”€â–º LOG_LEVEL=info
â”‚
â”œâ”€â”€ ğŸ“„ docker-compose.yml            # DOCKER ORCHESTRATION
â”‚   â”œâ”€â–º Ğ¡ĞµÑ€Ğ²Ğ¸Ñ: postgres
â”‚   â””â”€â–º Ğ¡ĞµÑ€Ğ²Ğ¸Ñ: api
â”‚
â”œâ”€â”€ ğŸ“„ Dockerfile                    # DOCKER IMAGE
â”‚   â”œâ”€â–º FROM node:18-alpine
â”‚   â”œâ”€â–º npm ci
â”‚   â”œâ”€â–º npm run build
â”‚   â””â”€â–º npm start
â”‚
â”œâ”€â”€ ğŸ“„ package.json                  # NPM DEPENDENCIES
â”‚   â”œâ”€â–º express, pg, zod, helmet...
â”‚   â””â”€â–º Scripts: dev, build, start
â”‚
â””â”€â”€ ğŸ“„ tsconfig.json                 # TYPESCRIPT CONFIG
    â””â”€â–º strict mode, ES2022, commonjs
```

---

## 5. ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº Ğ‘Ğ”

### Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .env Ñ„Ğ°Ğ¹Ğ»                                   â”‚
â”‚ DATABASE_URL=postgresql://                  â”‚
â”‚   postgres:postgres@                        â”‚
â”‚   localhost:5432/                           â”‚
â”‚   event_booking                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/config/env.ts                           â”‚
â”‚ â€¢ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ .env Ñ‡ĞµÑ€ĞµĞ· dotenv               â”‚
â”‚ â€¢ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‡ĞµÑ€ĞµĞ· Zod:                     â”‚
â”‚   envSchema.parse(process.env)              â”‚
â”‚ â€¢ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ‡Ñ‚Ğ¾ DATABASE_URL Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ URL   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/config/database.ts                      â”‚
â”‚                                             â”‚
â”‚ const pool = new Pool({                     â”‚
â”‚   connectionString: env.DATABASE_URL,       â”‚
â”‚   max: 20,           â† Ğ¼Ğ°ĞºÑ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹      â”‚
â”‚   idleTimeoutMillis: 30000,                 â”‚
â”‚   connectionTimeoutMillis: 2000             â”‚
â”‚ });                                         â”‚
â”‚                                             â”‚
â”‚ pool.on('error', (err) => {                 â”‚
â”‚   console.error('DB error', err);           â”‚
â”‚   process.exit(-1);                         â”‚
â”‚ });                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONNECTION POOL                             â”‚
â”‚                                             â”‚
â”‚  [Conn1] [Conn2] [Conn3] ... [Conn20]      â”‚
â”‚    â†“       â†“       â†“           â†“           â”‚
â”‚  idle    busy    idle        idle          â”‚
â”‚                                             â”‚
â”‚ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ:                  â”‚
â”‚ â€¢ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ          â”‚
â”‚ â€¢ ĞŸĞµÑ€ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ğ²ÑˆĞ¸ĞµÑÑ             â”‚
â”‚ â€¢ Ğ—Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ½ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ‡ĞµÑ€ĞµĞ· 30 ÑĞµĞº         â”‚
â”‚ â€¢ ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 20 Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğ¹      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Repository                  â”‚
â”‚                                             â”‚
â”‚ // ĞŸÑ€Ğ¾ÑÑ‚Ğ¾Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ĞºĞ»Ğ¸ĞµĞ½Ñ‚)  â”‚
â”‚ const result = await pool.query(           â”‚
â”‚   'SELECT * FROM events'                    â”‚
â”‚ );                                          â”‚
â”‚                                             â”‚
â”‚ // Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ (Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ¹ ĞºĞ»Ğ¸ĞµĞ½Ñ‚)              â”‚
â”‚ const client = await pool.connect();       â”‚
â”‚ try {                                       â”‚
â”‚   await client.query('BEGIN');             â”‚
â”‚   // SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹                            â”‚
â”‚   await client.query('COMMIT');            â”‚
â”‚ } finally {                                 â”‚
â”‚   client.release(); â† ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ!         â”‚
â”‚ }                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL Database                         â”‚
â”‚ Host: localhost (Ğ¸Ğ»Ğ¸ postgres Ğ² Docker)     â”‚
â”‚ Port: 5432                                  â”‚
â”‚ Database: event_booking                     â”‚
â”‚ User: postgres                              â”‚
â”‚ Password: postgres                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Connection Pool - ĞºĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

```
Ğ—ĞĞŸĞ ĞĞ¡ 1:                    Ğ—ĞĞŸĞ ĞĞ¡ 2:
   â”‚                            â”‚
   â–¼                            â–¼
pool.query()                pool.query()
   â”‚                            â”‚
   â”œâ”€â–º Ğ‘ĞµÑ€Ñ‘Ñ‚ Conn1              â”œâ”€â–º Ğ‘ĞµÑ€Ñ‘Ñ‚ Conn2
   â”‚   Ğ¸Ğ· Ğ¿ÑƒĞ»Ğ°                  â”‚   Ğ¸Ğ· Ğ¿ÑƒĞ»Ğ°
   â”‚                            â”‚
   â”œâ”€â–º Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ SQL            â”œâ”€â–º Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ SQL
   â”‚                            â”‚
   â””â”€â–º Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Conn1         â””â”€â–º Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Conn2
       Ğ² Ğ¿ÑƒĞ»                        Ğ² Ğ¿ÑƒĞ»

ĞŸĞĞ ĞĞ›Ğ›Ğ•Ğ›Ğ¬ĞĞ 25 Ğ—ĞĞŸĞ ĞĞ¡ĞĞ’:
   â”œâ”€â–º 20 Ğ±ĞµÑ€ÑƒÑ‚ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ Ğ¸Ğ· Ğ¿ÑƒĞ»Ğ° (max: 20)
   â””â”€â–º 5 Ğ¶Ğ´ÑƒÑ‚ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸ Ğ¿Ğ¾ĞºĞ° Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ñ‚ÑÑ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ
```

---

## 6. ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

### ĞšĞ°Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸                        â”‚
â”‚                                             â”‚
â”‚ $ npm run migrate:create add-new-table      â”‚
â”‚                                             â”‚
â”‚ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ñ„Ğ°Ğ¹Ğ»:                               â”‚
â”‚ migrations/1700123456789_add-new-table.sql  â”‚
â”‚           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚              timestamp                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ĞĞ°Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ SQL                            â”‚
â”‚                                             â”‚
â”‚ -- UP: Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸                  â”‚
â”‚ CREATE TABLE new_table (...);               â”‚
â”‚                                             â”‚
â”‚ -- DOWN: Ğ¾Ñ‚ĞºĞ°Ñ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸                     â”‚
â”‚ DROP TABLE new_table;                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸                      â”‚
â”‚                                             â”‚
â”‚ $ npm run migrate:up                        â”‚
â”‚                                             â”‚
â”‚ node-pg-migrate Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚:                     â”‚
â”‚ â”œâ”€â–º .pgmigraterc (Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸)               â”‚
â”‚ â”œâ”€â–º DATABASE_URL Ğ¸Ğ· env                     â”‚
â”‚ â””â”€â–º migrations/*.sql (Ğ¿Ğ¾ Ğ¿Ğ¾Ñ€ÑĞ´ĞºÑƒ)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ”                          â”‚
â”‚                                             â”‚
â”‚ PostgreSQL Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ SQL:                   â”‚
â”‚ â”œâ”€â–º Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ pgmigrations            â”‚
â”‚ â”‚   (Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¹)                      â”‚
â”‚ â”‚                                           â”‚
â”‚ â”œâ”€â–º ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ĞºĞ°ĞºĞ¸Ğµ ÑƒĞ¶Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ñ‹           â”‚
â”‚ â”‚                                           â”‚
â”‚ â”œâ”€â–º ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸                â”‚
â”‚ â”‚   Ğ² Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸                            â”‚
â”‚ â”‚                                           â”‚
â”‚ â””â”€â–º Ğ—Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ² pgmigrations               â”‚
â”‚     Ñ‡Ñ‚Ğ¾ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ°                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚                                â”‚
â”‚                                             â”‚
â”‚ Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ñ‹ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğº Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ!   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

```sql
-- migrations/1700000000000_create-tables.sql

-- ===== UP: ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ =====
-- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ events
CREATE TABLE events (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    total_seats INT NOT NULL CHECK (total_seats > 0),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ bookings
CREATE TABLE bookings (
    id SERIAL PRIMARY KEY,
    event_id INT NOT NULL REFERENCES events(id) ON DELETE CASCADE,
    user_id VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    -- Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ´ÑƒĞ±Ğ»ĞµĞ¹
    CONSTRAINT unique_user_event UNIQUE (event_id, user_id)
);

-- Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
CREATE INDEX idx_bookings_event_id ON bookings(event_id);
CREATE INDEX idx_bookings_user_id ON bookings(user_id);

-- Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
INSERT INTO events (name, total_seats) VALUES 
    ('Tech Conference 2025', 100),
    ('Music Festival', 500),
    ('Workshop: Node.js', 30);
```

### ĞÑ‚ĞºĞ°Ñ‚ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

```bash
# ĞÑ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ÑÑ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ
$ npm run migrate:down

# ĞÑ‚ĞºĞ°Ñ‚Ğ¸Ñ‚ÑŒ 3 Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
$ npm run migrate:down 3
```

### Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° pgmigrations

```sql
SELECT * FROM pgmigrations;

 id |        name                        |     run_on
----+------------------------------------+------------------
  1 | 1700000000000_create-tables.sql   | 2025-10-23 10:00
  2 | 1700000000001_add-users.sql       | 2025-10-23 11:00
```

---

## 7. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### Ğ“Ğ´Ğµ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. .env - ĞŸĞ•Ğ Ğ•ĞœĞ•ĞĞĞ«Ğ• ĞĞšĞ Ğ£Ğ–Ğ•ĞĞ˜Ğ¯ (Ğ“Ğ›ĞĞ’ĞĞ«Ğ™ Ğ¤ĞĞ™Ğ›)       â”‚
â”‚                                                     â”‚
â”‚ NODE_ENV=development                                â”‚
â”‚ PORT=3000                                           â”‚
â”‚ DATABASE_URL=postgresql://postgres:postgres@        â”‚
â”‚              localhost:5432/event_booking           â”‚
â”‚ LOG_LEVEL=info                                      â”‚
â”‚                                                     â”‚
â”‚ â— ĞĞ• ĞºĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ¸Ñ‚ÑÑ Ğ² Git (.gitignore)                 â”‚
â”‚ â— ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ¸Ğ¼ĞµĞµÑ‚ ÑĞ²Ğ¾Ğ¹ .env               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. .env.example - Ğ¨ĞĞ‘Ğ›ĞĞ                            â”‚
â”‚                                                     â”‚
â”‚ ĞšĞ¾Ğ¼Ğ¼Ğ¸Ñ‚Ğ¸Ñ‚ÑÑ Ğ² Git                                    â”‚
â”‚ ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ĞºĞ°ĞºĞ¸Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹                   â”‚
â”‚ Ğ‘ĞµĞ· Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ¾Ğ»ĞµĞ¹                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. docker-compose.yml - DOCKER ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜            â”‚
â”‚                                                     â”‚
â”‚ environment:                                        â”‚
â”‚   NODE_ENV: production                              â”‚
â”‚   DATABASE_URL: postgresql://postgres:postgres@     â”‚
â”‚                postgres:5432/event_booking          â”‚
â”‚   PORT: 3000                                        â”‚
â”‚                                                     â”‚
â”‚ â— ĞŸĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ .env Ğ´Ğ»Ñ Docker                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. tsconfig.json - TYPESCRIPT ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜             â”‚
â”‚                                                     â”‚
â”‚ {                                                   â”‚
â”‚   "strict": true,                                   â”‚
â”‚   "target": "ES2022",                               â”‚
â”‚   "module": "commonjs",                             â”‚
â”‚   ...                                               â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. package.json - NPM ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜                     â”‚
â”‚                                                     â”‚
â”‚ â€¢ Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ (dependencies)                        â”‚
â”‚ â€¢ Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ (scripts)                                 â”‚
â”‚ â€¢ Ğ’ĞµÑ€ÑĞ¸Ñ Node.js (engines)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. .pgmigraterc - ĞœĞ˜Ğ“Ğ ĞĞ¦Ğ˜Ğ˜ ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜                â”‚
â”‚                                                     â”‚
â”‚ {                                                   â”‚
â”‚   "migrations-dir": "migrations",                   â”‚
â”‚   "database-url-var": "DATABASE_URL",               â”‚
â”‚   "migration-file-language": "sql"                  â”‚
â”‚ }                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ°Ğº Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ

```
Ğ¡Ğ¢ĞĞ Ğ¢ ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ¯
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ import env from './config/env'   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ src/config/env.ts                â”‚
â”‚                                  â”‚
â”‚ 1. dotenv.config()               â”‚
â”‚    â””â”€â–º Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ .env Ñ„Ğ°Ğ¹Ğ»          â”‚
â”‚    â””â”€â–º Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ² process.env   â”‚
â”‚                                  â”‚
â”‚ 2. envSchema.parse(process.env)  â”‚
â”‚    â””â”€â–º Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‡ĞµÑ€ĞµĞ· Zod      â”‚
â”‚    â””â”€â–º ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚Ğ¸Ğ¿Ñ‹         â”‚
â”‚    â””â”€â–º Ğ•ÑĞ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° â†’ EXIT(1)     â”‚
â”‚                                  â”‚
â”‚ 3. export envConfig              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² ĞºĞ¾Ğ´Ğµ             â”‚
â”‚                                  â”‚
â”‚ import env from './config/env'   â”‚
â”‚                                  â”‚
â”‚ const PORT = env.PORT            â”‚
â”‚ const DB = env.DATABASE_URL      â”‚
â”‚ const LEVEL = env.LOG_LEVEL      â”‚
â”‚                                  â”‚
â”‚ âœ… Ğ¢Ğ¸Ğ¿Ğ¾Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾!                â”‚
â”‚ âœ… Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾!                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ JWT Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

#### Ğ¨Ğ°Ğ³ 1: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

```bash
npm install jsonwebtoken bcrypt
npm install --save-dev @types/jsonwebtoken @types/bcrypt
```

#### Ğ¨Ğ°Ğ³ 2: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ .env

```env
JWT_SECRET=your-secret-key-here
JWT_EXPIRES_IN=7d
```

#### Ğ¨Ğ°Ğ³ 3: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Zod ÑÑ…ĞµĞ¼Ñƒ

```typescript
// src/validators/index.ts
export const envSchema = z.object({
  // ... ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ
  JWT_SECRET: z.string().min(32),
  JWT_EXPIRES_IN: z.string().default('7d'),
});
```

#### Ğ¨Ğ°Ğ³ 4: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ users

```sql
-- migrations/1700000000002_add-users.sql

CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(255),
    role VARCHAR(50) DEFAULT 'user',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);

-- ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ bookings
ALTER TABLE bookings 
ADD COLUMN user_table_id INT REFERENCES users(id);
```

#### Ğ¨Ğ°Ğ³ 5: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ AuthService

```typescript
// src/services/authService.ts
import jwt from 'jsonwebtoken';
import bcrypt from 'bcrypt';
import env from '../config/env';

export class AuthService {
  async register(email: string, password: string) {
    const hash = await bcrypt.hash(password, 10);
    // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ² Ğ‘Ğ” Ñ‡ĞµÑ€ĞµĞ· userRepository
    const user = await userRepository.create(email, hash);
    return this.generateToken(user.id);
  }

  async login(email: string, password: string) {
    const user = await userRepository.findByEmail(email);
    if (!user) throw new UnauthorizedError();
    
    const valid = await bcrypt.compare(password, user.password_hash);
    if (!valid) throw new UnauthorizedError();
    
    return this.generateToken(user.id);
  }

  private generateToken(userId: number) {
    return jwt.sign(
      { userId },
      env.JWT_SECRET,
      { expiresIn: env.JWT_EXPIRES_IN }
    );
  }

  verifyToken(token: string) {
    return jwt.verify(token, env.JWT_SECRET);
  }
}
```

#### Ğ¨Ğ°Ğ³ 6: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Auth middleware

```typescript
// src/middleware/auth.ts
import { Request, Response, NextFunction } from 'express';
import authService from '../services/authService';

// Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼ Request Ñ‚Ğ¸Ğ¿
declare global {
  namespace Express {
    interface Request {
      userId?: number;
    }
  }
}

export const authenticate = (
  req: Request,
  res: Response,
  next: NextFunction
): void => {
  try {
    const token = req.headers.authorization?.split(' ')[1];
    if (!token) {
      res.status(401).json({ error: 'No token provided' });
      return;
    }

    const decoded = authService.verifyToken(token) as { userId: number };
    req.userId = decoded.userId;
    next();
  } catch (error) {
    res.status(401).json({ error: 'Invalid token' });
  }
};

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ¾Ğ»ĞµĞ¹
export const authorize = (...roles: string[]) => {
  return async (req: Request, res: Response, next: NextFunction) => {
    const user = await userRepository.findById(req.userId!);
    if (!user || !roles.includes(user.role)) {
      res.status(403).json({ error: 'Insufficient permissions' });
      return;
    }
    next();
  };
};
```

#### Ğ¨Ğ°Ğ³ 7: Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ¸Ñ‚ÑŒ Ñ€Ğ¾ÑƒÑ‚Ñ‹

```typescript
// src/routes/bookingRoutes.ts
import { authenticate, authorize } from '../middleware/auth';

const router = Router();

// ĞŸÑƒĞ±Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ñ€Ğ¾ÑƒÑ‚Ñ‹
router.get('/event/:eventId', bookingController.getBookingsByEventId);

// Ğ—Ğ°Ñ‰Ğ¸Ñ‰Ñ‘Ğ½Ğ½Ñ‹Ğµ Ñ€Ğ¾ÑƒÑ‚Ñ‹
router.post(
  '/reserve',
  authenticate,  // â† Ğ¢Ñ€ĞµĞ±ÑƒĞµÑ‚ JWT Ñ‚Ğ¾ĞºĞµĞ½
  validateBody(createBookingSchema),
  bookingController.createBooking
);

// Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¾Ğ²
router.delete(
  '/:id',
  authenticate,
  authorize('admin'),  // â† Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ñ‹
  bookingController.deleteBooking
);
```

#### Ğ¨Ğ°Ğ³ 8: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Auth routes

```typescript
// src/routes/authRoutes.ts
import { Router } from 'express';
import authController from '../controllers/authController';

const router = Router();

router.post('/register', authController.register);
router.post('/login', authController.login);
router.get('/me', authenticate, authController.getCurrentUser);

export default router;
```

#### Ğ¨Ğ°Ğ³ 9: ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€

```typescript
// src/routes/index.ts
import authRoutes from './authRoutes';

router.use('/auth', authRoutes);
router.use('/bookings', bookingRoutes);
router.use('/events', eventRoutes);
```

### Ğ¡Ñ…ĞµĞ¼Ğ° Ñ Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹

```
ĞšĞ›Ğ˜Ğ•ĞĞ¢
  â”‚
  â”‚ 1. POST /api/auth/register
  â”‚    Body: {email, password}
  â–¼
AuthController
  â”‚
  â–¼
AuthService.register()
  â”œâ”€â–º bcrypt.hash(password)
  â”œâ”€â–º userRepository.create()
  â””â”€â–º jwt.sign({userId})
  â”‚
  â–¼
Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚: { token: "eyJhbGc..." }

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ĞšĞ›Ğ˜Ğ•ĞĞ¢ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ token
  â”‚
  â”‚ 2. POST /api/bookings/reserve
  â”‚    Headers: Authorization: Bearer <token>
  â”‚    Body: {event_id, user_id}
  â–¼
authenticate middleware
  â”œâ”€â–º Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ token Ğ¸Ğ· headers
  â”œâ”€â–º jwt.verify(token, JWT_SECRET)
  â”œâ”€â–º req.userId = decoded.userId
  â”‚
  â–¼ Token Ğ²Ğ°Ğ»Ğ¸Ğ´ĞµĞ½
  â”‚
bookingController.createBooking()
  â””â”€â–º Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ req.userId
```

### Ğ”Ñ€ÑƒĞ³Ğ¸Ğµ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ğ ĞĞ¡Ğ¨Ğ˜Ğ Ğ•ĞĞ˜Ğ¯ Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞ«                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚ 1. Rate Limiting                                    â”‚
â”‚    â””â”€â–º npm install express-rate-limit               â”‚
â”‚    â””â”€â–º ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ½Ğ° IP                  â”‚
â”‚                                                     â”‚
â”‚ 2. Redis Caching                                    â”‚
â”‚    â””â”€â–º npm install redis                            â”‚
â”‚    â””â”€â–º ĞšĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹                  â”‚
â”‚                                                     â”‚
â”‚ 3. WebSockets Ğ´Ğ»Ñ real-time                         â”‚
â”‚    â””â”€â–º npm install socket.io                        â”‚
â”‚    â””â”€â–º ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ¼ĞµÑÑ‚ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ â”‚
â”‚                                                     â”‚
â”‚ 4. Email ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ                                â”‚
â”‚    â””â”€â–º npm install nodemailer                       â”‚
â”‚    â””â”€â–º ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğ¹ Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ         â”‚
â”‚                                                     â”‚
â”‚ 5. Pagination & Filtering                           â”‚
â”‚    â””â”€â–º Query parameters: ?page=1&limit=10           â”‚
â”‚    â””â”€â–º Repositories Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ offset/limit       â”‚
â”‚                                                     â”‚
â”‚ 6. API Documentation                                â”‚
â”‚    â””â”€â–º npm install swagger-jsdoc swagger-ui-express â”‚
â”‚    â””â”€â–º ĞĞ²Ñ‚Ğ¾Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ OpenAPI docs                   â”‚
â”‚                                                     â”‚
â”‚ 7. Testing                                          â”‚
â”‚    â””â”€â–º npm install jest supertest                   â”‚
â”‚    â””â”€â–º Unit tests + Integration tests               â”‚
â”‚                                                     â”‚
â”‚ 8. ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³                                       â”‚
â”‚    â””â”€â–º npm install prom-client                      â”‚
â”‚    â””â”€â–º Prometheus metrics endpoint                  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ ĞµĞ·ÑĞ¼Ğµ

**ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹:**

1. **Separation of Concerns** - ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ·Ğ° ÑĞ²Ğ¾Ñ‘
2. **Dependency Injection** - Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¿ĞµÑ€ĞµĞ´Ğ°ÑÑ‚ÑÑ, Ğ° Ğ½Ğµ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ÑÑ
3. **Single Responsibility** - Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ»Ğ°ÑÑ = Ğ¾Ğ´Ğ½Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
4. **Type Safety** - TypeScript + Zod Ğ´Ğ»Ñ runtime Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸
5. **Error Handling** - Ñ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
6. **Transaction Management** - Ğ´Ğ»Ñ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
7. **Connection Pooling** - ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ‘Ğ”
8. **Environment Validation** - Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
9. **Graceful Shutdown** - ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹
10. **Extensibility** - Ğ»ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ„Ğ¸Ñ‡Ğ¸

**Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº:**
- âœ… Production deployment
- âœ… Ğ“Ğ¾Ñ€Ğ¸Ğ·Ğ¾Ğ½Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ Ğ¼Ğ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- âœ… Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ñ„Ğ¸Ñ‡
- âœ… Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼Ğ¸
- âœ… ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ñƒ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
